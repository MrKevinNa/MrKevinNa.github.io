2018 프로야구 기사 이모저모 (탐색적 데이터 분석)
================
Dr.Kevin
12/21/2018

2018년 프로야구는 **SK 와이번즈**의 우승으로 막을 내렸습니다. 그저 TV로만 가끔 관심 있는 경기를 시청하는 미지근한 팬의 한 명으로서, 올해 많은 고생을 한 프로야구 관계자분들께 감사하다는 말씀을 드리고 싶습니다.

평소 프로야구 기사와 댓글을 즐겨 읽기 때문에 그 안에 담긴 공통된 생각을 정리해보고 싶었습니다. 그동안 시간이 없어서 엄두를 내지 못했는데요. 이번에 관련 기사를 모두 모아 간단한 분석 몇 가지를 수행해봤습니다. 전체 작업 프로세스는 아래와 같습니다.

데이터 수집 프로세스 (전처리 과정 포함)
---------------------------------------

1.  [네이버 프로야구 최신뉴스 웹페이지](https://sports.news.naver.com/kbaseball/news/index.nhn?isphoto=N)에서 일자별로 등록된 뉴스의 링크를 수집합니다. 이 과정에서 `뉴스등록일자`, `(네이버가 부여한) 언론사ID`, `(네이버가 부여한) 뉴스ID`, `뉴스제목`, `링크(url)`, `언론사명` 등을 수집할 수 있습니다. 2018년 1월 1일부터 11월 30일까지 수집한 건수는 **49,076건**이었습니다만 이 숫자는 매일 바뀝니다. 그리고 무엇보다 같은 뉴스가 서로 다른 날짜에 등록되기도 합니다. 그래서 링크로 중복을 제거하니 **42,390건**으로 줄었습니다.

2.  프로야구 뉴스 링크(url)를 모두 모았으면 해당 **뉴스별로 본문, 반응, 댓글** 등 3가지를 나눠서 수집할 수 있습니다. **본문**을 수집하면 정규식을 활용하여 해당 기사를 작성한 `기자의 이름`과 `이메일`을 추출할 수 있는데요. 문제는 언론사별로 양식이 제각각이라 깔끔한 정규식으로는 해결이 되지 않아 지저분한 방식을 모두 동원해야 했습니다.

3.  다음으로 **반응** 데이터를 수집하면 다음과 같은 5가지 숫자를 얻을 수 있습니다. `좋아요`, `슾퍼요`, `화나요`, `팬이에요(힘내요)`, `후속기사(원해요)`, 그리고 이 5가지 숫자를 더한 `총반응`을 계산합니다. 이 반응 값을 기준으로 언론사별, 기자별, 구단별 다양한 현황을 살펴볼 수 있었습니다.

4.  마지막으로 **댓글** 데이터를 수집할 수 있는데요. 댓글을 모두 모으니 **5백만 건**이 넘었습니다. 뉴스별로 댓글의 숫자를 계산했습니다. 댓글은 따로 텍스트 마이닝을 하려고 했는데요. 이번 발표에는 포함시키지 못했습니다. 일단 데이터량이 방대하기도 했고, 시간도 부족했습니다. 나중에 12월 뉴스 데이터까지 추가로 수집한 다음에 시간이 있으면 꼭 정리해보도록 하겠습니다.

5.  이상의 4가지 데이터셋을 수집한 다음 하나의 커다란 [마스터 데이터셋](https://github.com/MrKevinNa/MrKevinNa.github.io/blob/master/data/naver_baseball_news_2018.RDS)을 만들었습니다.[1] 마스터 데이터셋에는 **링크와 뉴스 제목, 언론사명, 기자명, 이메일, 반응 데이터, 댓글 수, 그리고 관련 선수와 구단** 등의 컬럼으로 구성되어 있습니다. 직접 분석을 해보시기 바랍니다.

2018 프로야구 기사로 살펴본 이모저모
------------------------------------

지금부터 마스터 데이터를 가지고 여러 가지 그래프를 그려볼 예정입니다. 데이터를 먼저 불러와야 되겠죠?

``` r
# 마스터 데이터를 읽습니다. 
news <- readRDS(file = '../data/naver_baseball_news_2018.RDS')

# 데이터의 구조를 확인합니다. 
str(object = news)
```

    ## 'data.frame':    42390 obs. of  19 variables:
    ##  $ oid     : chr  "001" "001" "001" "001" ...
    ##  $ aid     : chr  "0009775779" "0009783524" "0009783968" "0009785759" ...
    ##  $ url     : chr  "https://sports.news.naver.com/kbaseball/news/read.nhn?oid=001&aid=0009775779" "https://sports.news.naver.com/kbaseball/news/read.nhn?oid=001&aid=0009783524" "https://sports.news.naver.com/kbaseball/news/read.nhn?oid=001&aid=0009783968" "https://sports.news.naver.com/kbaseball/news/read.nhn?oid=001&aid=0009785759" ...
    ##  $ date    : chr  "20180102" "20180101" "20180101" "20180103" ...
    ##  $ title   : chr  "kt 류택현·신명철·고영민 1군 코치로…최영필 합류" "정운찬 KBO 총재 시대…한국 야구 어떻게 달라질까" "정운찬 KBO총재 신년사 \"야구가 삶에 '힐링'이 될 수 있도록\"" "프로야구 스프링캠프 'D-30'…2018년 우승 향한 '위대한 도전'" ...
    ##  $ press   : chr  "연합뉴스" "연합뉴스" "연합뉴스" "연합뉴스" ...
    ##  $ body    : chr  "고영민 kt 코치[촬영 최인영](서울=연합뉴스) 최인영 기자 = kt wiz가 김진욱 감독과 함께 선수단을 이끌 2018시즌 코"| __truncated__ "'동반성장' 접목해 야구를 '한국인의 힐링'으로 바꿀 포부통합 마케팅·에이전트 시행·국제대회 지원 등 현안 산적KBO "| __truncated__ "클린베이스볼 실천·FA제도 개선·아마야구 성장 지원 의지 등 밝혀정운찬 KBO 신임 총재. [연합뉴스 자료사진](서울=연"| __truncated__ "챔피언 KIA·한화·삼성 3개 팀 일본 오키나와서만 '담금질'NC·넥센·kt 미국서 구슬땀…두산 호주·롯데 대만서 1차 훈련시"| __truncated__ ...
    ##  $ email   : chr  "abbie@yna.co.kr" "cany9900@yna.co.kr" "hosu1@yna.co.kr" "cany9900@yna.co.kr" ...
    ##  $ rname   : chr  "최인영" "장현구" "배진남" "임헌정" ...
    ##  $ reporter: chr  "연합뉴스\n최인영" "연합뉴스\n장현구" "연합뉴스\n배진남" "연합뉴스\n임헌정" ...
    ##  $ angry   : num  2 13 21 5 96 3 0 2 0 12 ...
    ##  $ fan     : num  3 0 1 13 26 4 0 0 0 1 ...
    ##  $ like    : num  10 3 15 52 112 12 0 6 1 3 ...
    ##  $ sad     : num  0 0 0 3 4 1 0 0 0 0 ...
    ##  $ want    : num  1 1 0 5 7 2 0 0 0 4 ...
    ##  $ resp    : num  16 17 37 78 245 22 0 8 1 20 ...
    ##  $ comt    : num  27 42 78 84 532 55 0 7 8 27 ...
    ##  $ name    : chr  NA NA NA NA ...
    ##  $ team    : chr  "KT" NA NA NA ...

제가 불러온 마스터 데이터는 `42390` 행, `19` 열을 갖는 데이터 프레임입니다.

다음으로 막대그래프에 적용할 나의 테마를 설정하면 준비가 완료됩니다.

``` r
# 나의 테마를 설정합니다. 
mytheme <- theme(
  plot.title = element_text(size = 14, face = 'bold', hjust = 0.5),
  axis.title.x = element_text(color = 'blue', size = 12, face = 'bold'),
  axis.title.y = element_text(color = '#993333', size = 12, face = 'bold'),
  axis.text.x = element_text(family = 'NanumGothic', size = 10, face = 'bold'),
  axis.text.y = element_text(family = 'NanumGothic', size = 10, face = 'bold'),
  axis.ticks.length = unit(0, 'cm'),
  panel.background = element_blank(),
  panel.grid = element_blank() )
```

### 조건별 뉴스의 건수와 비중

1.  전체 뉴스 중 언론사 및 기자별 건수와 비중을 확인합니다. (올해 누가 열일했는지 알 수 있겠죠?)

2.  상위 언론사에 소속된 기자별로 건수와 비중을 확인합니다.

3.  뉴스 제목에 언급된 구단명과 선수명을 기준으로 가장 많이 언급된 구단과 선수를 확인합니다. (어떤 선수가 가장 많은 관심을 받았을까요?)

#### 1. 언론사별 뉴스 기사 건수와 비중

``` r
# 필요한 패키지를 불러옵니다. 
library(tidyverse)
library(magrittr)
```

지금부터 막대그래프를 그리는 사용자 정의 함수를 몇 가지 소개해드리겠습니다. 제가 부족한 부분이 많아서 함수 모양이 예쁘지 않으니 양해해주시기 바랍니다. 함수를 보시고 스스로 응용해서 사용할 수 있는 아이디어를 얻게 되신다면 기쁠 것 같습니다. 아래 함수는 최대 20개 언론사 또는 기자에 대해 작성한 뉴스 건수별로 내림차순 정렬을 한 다음 상위 20건만 보이도록 한 것입니다.

``` r
# 데이터프레임의 변수를 설정하면 해당 변수에 속한 값으로 막대그래프를 그립니다. 
# sub 인자에는 그래프 제목에 들어갈 부제를 넣어주면 됩니다. 
bargraphVar <- function(var, sub) {
  
  # var에 할당된 문자열을 이용하여 R객체의 값을 선택할 수 있도록 설정합니다. 
  var <- str_c('news', var, sep = '$') %>% parse(text = .) %>% eval()
  
  # 지정된 컬럼으로 빈도수를 갖는 데이터프레임을 생성합니다.
  tbl <- var %>% 
    table() %>% 
    sort(decreasing = TRUE) %>% 
    as.data.frame() %>% 
    set_colnames(value = c('name', 'freq'))
  
  # 빈도수에 콤마를 추가합니다. 
  tbl$freqn <- tbl$freq %>% format(big.mark = ',')
  
  # 전체 건수 대비 비중 컬럼을 생성합니다. 
  tbl$pcnt <- (tbl$freq / sum(x = tbl$freq) * 100) %>% 
    sprintf(fmt = '%.2f', x = .) %>% 
    str_pad(width = 4, side = 'right', pad = '0')
  
  # 막대그래프로 그립니다. 
  ggplot(
    data = head(x = tbl, n = 20L), 
    mapping = aes(
      x = reorder(x = name, X = freq),
      y = freq)) + 
    geom_bar(
      stat = 'identity', 
      fill = c(rep(x = 'gray80', times = 15), 
               rep(x = 'gray30', times = 5))) +
    geom_text(
      mapping = aes(label = str_c(freqn, ' (', pcnt, '%)')), 
      hjust = -0.1, 
      size = 4) + 
    labs(
      x = '',
      y = '뉴스 건수 (비중)',
      title = str_c('2018년 프로야구 기사 빈도수 (', sub, ')')) + 
    scale_y_continuous(limits = c(0, max(x = tbl$freq) * 1.2)) + 
    coord_flip() + 
    mytheme + 
    theme(axis.text.x = element_blank() )
  
}
```

``` r
# 언론사별로 뉴스 건수와 비중을 확인합니다. 
bargraphVar(var = 'press', sub = '언론사')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-5-1.png)

**OSEN**이라는 언론사의 `7302`건의 기사가 네이버에 소개되었습니다. 전체 프로야구 기사의 17.23%의 비중을 차지하는 군요. 그리고 각 4천여 건의 기사가 스포츠조선과 스포티비뉴스에서 작성되었습니다.

``` r
# 기자별로 뉴스 건수와 비중을 확인합니다. 
bargraphVar(var = 'reporter', sub = '기자')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-6-1.png)

기자 중에서는 OSEN의 이상학 기자가 근소한 차이로 1위를 차지했습니다. 그 뒤를 스포티비뉴스의 한희재 기자가 바짝 따라붙었네요. 11개월 동안 1400여 건의 기사를 작성했는데 그렇다면 하루에 4.2건 정도를 기사를 (주말도 없이) 매일 작성한 것입니다. 대단합니다!!

#### 2. 뉴스 비중 상위 언론사별 소속 기자들이 작성한 뉴스의 건수와 비중

실력이 뛰어난 분석가는 같은 코드를 중복하지 않는다고 하지만 저는 아직 갈길이 멉니다. 바쁘다는 핑계로 앞서 작성한 사용자 정의 함수를 복사해서 일부만 수정했습니다. 예컨데 언론사별로 기자를 선택하는 부분이 다르고, 해당 언론사에서 프로야구 기사를 작성한 기자의 수가 최대 20명이 되도록 설정한 것입니다.

``` r
# 언론사별 기자가 작성한 뉴스의 건수와 비중을 확인하는 사용자 정의 함수를 생성합니다. 
bargraphPress <- function(press) {
  
  # var에 할당된 문자열을 이용하여 R객체의 값을 선택할 수 있도록 설정합니다. 
  var <- news$rname[news$press == press]
  
  # 지정된 컬럼으로 빈도수를 갖는 데이터프레임을 생성합니다.
  tbl <- var %>% 
    table() %>% 
    sort(decreasing = TRUE) %>% 
    as.data.frame() %>% 
    set_colnames(value = c('name', 'freq'))
  
  # 기자의 수가 최대 20명이 되도록 설정합니다. 
  n <- min(nrow(x = tbl), 20)
  
  # 빈도수에 콤마를 추가합니다. 
  tbl$freqn <- tbl$freq %>% format(big.mark = ',')
  
  # 전체 건수 대비 비중 컬럼을 생성합니다. 
  tbl$pcnt <- (tbl$freq / sum(x = tbl$freq) * 100) %>% 
    sprintf(fmt = '%.2f', x = .) %>% 
    str_pad(width = 4, side = 'right', pad = '0')
  
  # 막대그래프로 그립니다. 
  ggplot(
    data = head(x = tbl, n = n), 
    mapping = aes(
      x = reorder(x = name, X = freq),
      y = freq)) + 
    geom_bar(
      stat = 'identity', 
      fill = c(rep(x = 'gray80', times = n - 5), 
               rep(x = 'gray30', times = 5))) +
    geom_text(
      mapping = aes(label = str_c(freqn, ' (', pcnt, '%)')), 
      hjust = -0.1, 
      size = 4) + 
    labs(
      x = '',
      y = '뉴스 건수 (비중)',
      title = str_c('2018년 프로야구 기사 빈도수 (', press, ')')) + 
    scale_y_continuous(limits = c(0, max(x = tbl$freq) * 1.2)) + 
    coord_flip() + 
    mytheme + 
    theme(axis.text.x = element_blank() )
  
}
```

``` r
# 1위 언론사에는 어떤 기자들이 활동했을까요? 
bargraphPress(press = 'OSEN')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-8-1.png)

``` r
# 2위와 3위 언론사도 한 번 살펴보겠습니다. 
bargraphPress(press = '스포츠조선')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-9-1.png)

``` r
bargraphPress(press = '스포티비뉴스')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-9-2.png)

``` r
# 마지막으로 제가 가장 관심 있는 기자가 속한 언론사입니다. 
bargraphPress(press = '국민일보')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-10-1.png)

역시 국민일보의 에이스는 김영석 기자, 일명 `영석이형`이었습니다.

혹시 이밖에 다른 언론사 현황이 궁금하시면 직접 해보시기 바랍니다.

#### 3. 뉴스 제목에서 언급된 구단 및 선수별 건수

``` r
# 뉴스 제목에서 언급된 구단별 뉴스 건수를 확인합니다. (중복 있음)
mostTeam <- news$team %>% 
  str_split(pattern = ',') %>% 
  unlist() %>% 
  table() %>% 
  sort(decreasing = TRUE) %>% 
  as.data.frame(stringsAsFactors = FALSE) %>% 
  set_colnames(c('구분', '빈도'))

print(x = mostTeam)
```

    ##    구분 빈도
    ## 1  한화 5424
    ## 2    LG 5231
    ## 3  두산 5181
    ## 4  롯데 4739
    ## 5   KIA 4429
    ## 6  넥센 3904
    ## 7    SK 3703
    ## 8  삼성 3308
    ## 9    NC 2201
    ## 10   KT 2153

올 한 해 가장 많은 기사로 언급된 구단은 바로 **한화 이글즈**였습니다. 가을야구에 진출한 것이 11년만이어서 일까요? 아무튼 대단한 사랑을 받았습니다.

``` r
# 뉴스 제목에서 언급된 선수별 뉴스 건수를 확인합니다.  (중복 있음)
mostName <- news$name %>% 
  str_split(pattern = ',') %>% 
  unlist() %>% 
  table() %>% 
  sort(decreasing = TRUE) %>% 
  as.data.frame(stringsAsFactors = FALSE) %>% 
  set_colnames(c('구분', '빈도'))

print(x = mostName[1:10, ])
```

    ##      구분 빈도
    ## 1  박병호  795
    ## 2  김재환  572
    ## 3  양현종  567
    ## 4  김현수  565
    ## 5  김광현  518
    ## 6  오지환  512
    ## 7  이정후  471
    ## 8  이대호  451
    ## 9    호잉  451
    ## 10 양의지  450

가장 많이 언급된 선수는 **넥센 히어로즈**의 **박병호** 선수였습니다. 제 예상과 달라서 조금 당황스러웠어요.

### 뉴스 기사의 반응 항목별 현황

이번에는 각 뉴스 기사마다 `좋아요`, `슾퍼요`, `화나요`, `팬이에요(힘내요)`, `후속기사(원해요)` 등 다섯 가지 항목에 대해 팬들의 반응 데이터로 여러 가지를 살펴보겠습니다. 순서는 아래와 같습니다.

1.  각 항목별 가장 높은 반응을 받은 상위 기사 제목을 출력해봅니다.

2.  언론사 및 기자별로 작성한 뉴스 기사에 대한 평균 반응값을 확인하고 특징을 연구해봅니다. (이걸로 어워드를 드릴 수도)

3.  구단 및 선수별로 관련 기사의 평균 반응을 확인합니다.

4.  구단별 관련 기사 중 가장 높은 반응을 받은 기사의 제목을 출력해봅니다.

#### 1. 각 항목별로 가장 높은 반응을 받은 기사 목록

``` r
# 반응 항목별로 가장 인기 있었던 기사를 확인하는 사용자 정의 함수를 생성합니다. 
checkResponse <- function(data, resp, top = 5) {
  
  # data와 resp 인자를 문자로 받아 R 객체의 값을 불러오도록 설정합니다. 
  dtn <- deparse(expr = substitute(expr = data))
  var <- str_c(dtn, resp, sep = '$') %>% parse(text = .) %>% eval()
  
  # 출력할 컬럼명을 지정합니다.
  cols <- c('date', 'title', 'press', 'rname', 'resp', 'like', 'sad', 'angry', 'fan', 'want')
  
  # 가장 많은 표를 얻은 기사만 추출합니다.
  article <- data[order(var, decreasing = TRUE), cols] %>% head(n = top)
  
  # 상위 기사를 출력합니다. 
  print(x = article)
  
}
```

``` r
# '좋아요'를 가장 많이 받은 기사 목록입니다.
checkResponse(data = news, resp = 'like', top = 10)
```

    ##           date
    ## 18419 20180826
    ## 27225 20181113
    ## 18551 20180902
    ## 7994  20180607
    ## 33321 20180914
    ## 12815 20181115
    ## 26391 20180523
    ## 22624 20181103
    ## 11648 20180506
    ## 18428 20180828
    ##                                                                            title
    ## 18419                   [AG] '실업 투수들에 1득점' 한국, 대만전 충격패…金 적신호
    ## 27225                  '한동민 결승포+김광현 SV' SK, 두산 꺾고 8년 만에 KS 우승!
    ## 18551                '양현종 호투-박병호 홈런' 한국, 일본 꺾고 3회 연속 金! [AG]
    ## 7994                      두산 구단 발표 "이영하, 승부조작 제안받고 곧바로 신고"
    ## 33321                     선동열 야구감독 '청탁금지법' 위반 혐의 권익위 신고당해
    ## 12815                    'KS 분패 후...' 나 홀로 남아 팬들에 사인해 준 두산 선수
    ## 26391                   '송광민 끝내기' 한화의 재역전 드라마, 두산 꺾고 단독 2위
    ## 22624 [PO 5차전]'한동민 10회말 끝내기홈런' SK, 혈투 끝 넥센 제압…6년만에 KS 진출
    ## 11648                           "사인해주세요" 외면 NO… 전부 다 해준 선수 '훈훈'
    ## 18428              ‘대만이 이겼는데 한국사람들은 고맙다니?’ 어리둥절한 대만 언론
    ##              press  rname resp like sad angry fan want
    ## 18419         OSEN 이상학 6940 4900 117  1708 127   88
    ## 27225 엑스포츠뉴스 조은혜 5303 4338  41   161 725   38
    ## 18551         OSEN 이상학 9213 3387  94  5435 198   99
    ## 7994    스포츠조선 허상욱 3962 3317  19   152 422   52
    ## 33321        뉴스1 황기선 4351 3174  54   915  59  149
    ## 12815     스타뉴스 김우종 3908 3125  78   216 453   36
    ## 26391 엑스포츠뉴스 조은혜 2909 2308  20   135 416   30
    ## 22624   마이데일리 김진성 2854 2156 121   158 386   33
    ## 11648     스타뉴스 김우종 2444 2043  16    58 295   32
    ## 18428         OSEN 서정환 2673 2000  60   447  67   99

놀랍게도 아시안게임 대만전 충격패 기사가 가장 많은 '좋아요'를 받았습니다. 당시 분위기로 짐작하면 충분히 가능할 일이죠.

``` r
# '슬퍼요'를 가장 많이 받은 기사 목록입니다.
checkResponse(data = news, resp = 'sad', top = 10)
```

    ##           date
    ## 27366 20181128
    ## 21711 20180604
    ## 19397 20181014
    ## 28361 20181029
    ## 2370  20180925
    ## 39104 20180619
    ## 12852 20181125
    ## 11901 20180606
    ## 40731 20181109
    ## 17477 20180714
    ##                                                                     title
    ## 27366         [이영미 人터뷰] 로저 버나디나, “다시 KBO리그에서 뛰고 싶다”
    ## 21711                           NC 김경문 감독 사퇴, 유영준 단장 감독대행
    ## 19397                         힐만 감독, SK 재계약 고사… PS 끝으로 떠난다
    ## 28361               “팬 여러분 부탁드립니다” 임창용, 진실공방 속 심경고백
    ## 2370                  “롯데, 이러면 가을야구 TV로 본다?” 연이은 불펜 방화
    ## 39104                           “돌아가기 싫다” 로저스 개인 방송에서 눈물
    ## 12852 'SK 작별' 정경배 코치가 말한 힐만·최정·로맥, 그리고 심경 [일문일답]
    ## 11901             '뼈가 조각나고도..' 2루로 공 던진 로저스, 그리고 울었다
    ## 40731                넥센 브리검, 동료들도 몰랐던 '딸을 잃은 통곡의 사연'
    ## 17477                         한화 떠나는 휠러의 미련, 타팀 이적 기다린다
    ##              press  rname resp like  sad angry fan want
    ## 27366  이영미 칼럼 이영미 3134  505 2208   194 206   21
    ## 21711   마이데일리 윤욱재 2372  216 1562   476  53   65
    ## 19397         OSEN 김태우 1803  220 1462    43  47   31
    ## 28361   스포츠동아 장은상 2381  155 1419   653  66   88
    ## 2370      국민일보 김영석 1456   33 1304    68  28   23
    ## 39104 스포티비뉴스 김건일 1204   75  922   140  29   38
    ## 12852     스타뉴스 박수진 1103   25  902   145  17   14
    ## 11901     스타뉴스 김우종 1044   93  876    22  27   26
    ## 40731 스포티비뉴스 고유라  956   52  843    18  34    9
    ## 17477         OSEN 이상학  995   68  811    72  23   21

전 KIA 소속 외국인 타자였던 버나디나와 인터뷰한 기사가 가장 많은 '슬퍼요'를 받았습니다. 호타준족에 쇼맨쉽도 좋아서 그런지 많은 KIA 팬들이 아쉬움을 달래야 했습니다.

``` r
# '화나요'를 가장 많이 받은 기사 목록입니다.
checkResponse(data = news, resp = 'angry', top = 10)
```

    ##           date
    ## 18551 20180902
    ## 19894 20181117
    ## 18543 20180902
    ## 22702 20181119
    ## 18581 20180904
    ## 22235 20180902
    ## 25952 20181026
    ## 3481  20180905
    ## 30311 20180114
    ## 10923 20180125
    ##                                                                    title
    ## 18551        '양현종 호투-박병호 홈런' 한국, 일본 꺾고 3회 연속 金! [AG]
    ## 19894                      선동렬 사퇴시킨 손혜원 의원, 속 시원하십니까?
    ## 18543                 1년 전 오지환의 꿈과 선택, 이토록 비난 받을 일인가
    ## 22702                 두산 김재환, 금지약물 논란 딛고 최우수 선수 '우뚝'
    ## 18581                인민재판 받은 오지환, 야구인들의 안타까운 시선 [AG]
    ## 22235                      '금메달' 오지환·박해민, 아시안게임은 해피엔딩
    ## 25952                                         KIA-임창용 방출의 미스테리
    ## 3481  오지환 논란에 靑청원까지…“병역 혜택 취소하라” “오지환법 제정 촉구”
    ## 30311         안우진 "야구 잘하겠다"…뉘우침 없는 삐뚤어진 인식의 씁쓸함 
    ## 10923    [공식발표] 넥센, '학교폭력' 안우진에 '50G 출장정지' 자체 중징계
    ##            press  rname resp like sad angry fan want
    ## 18551       OSEN 이상학 9213 3387  94  5435 198   99
    ## 19894       OSEN 이상학 6179  534  61  5429  60   95
    ## 18543       OSEN 한용섭 6579 1656  70  4703  84   66
    ## 22702 마이데일리 이후광 4488  631  18  3742  82   15
    ## 18581       OSEN 이상학 4122  187 151  3681  50   53
    ## 22235 마이데일리 김진성 4334  671  25  3569  49   20
    ## 25952 일간스포츠 이형석 4323  228  80  3532  33  450
    ## 3481    동아일보 김민성 3884  346 137  3229  91   81
    ## 30311   MK스포츠 한이정 3709  315  22  3195  34  143
    ## 10923   스타뉴스 김우종 3267  145  32  2961  57   72

아시안게임 금메달 소식이 가장 많은 '화나요'를 받았다니 정말 슬프네요. 다시는 이런 일이 없어야 하겠습니다.

``` r
# '팬이에요'를 가장 많이 받은 기사 목록입니다.
checkResponse(data = news, resp = 'fan', top = 10)
```

    ##           date
    ## 27225 20181113
    ## 1286  20181104
    ## 571   20180523
    ## 12815 20181115
    ## 19744 20181104
    ## 7994  20180607
    ## 19840 20181111
    ## 26391 20180523
    ## 20007 20181120
    ## 12749 20181108
    ##                                                                  title
    ## 27225        '한동민 결승포+김광현 SV' SK, 두산 꺾고 8년 만에 KS 우승!
    ## 1286           엑소 찬열, 한국시리즈 2차전 시구…애국가는 우주소녀 연정
    ## 571               '화요일의 남자' 호잉 "부모님이 받은 박수, 나도 감격"
    ## 12815          'KS 분패 후...' 나 홀로 남아 팬들에 사인해 준 두산 선수
    ## 19744 [KS1] '한동민-박정권 투런 합창' SK, 두산에 7-3 역전승...기선제압
    ## 7994            두산 구단 발표 "이영하, 승부조작 제안받고 곧바로 신고"
    ## 19840         [오!쎈 현장] “힐만!” 연호한 SK팬들, 가슴 뜨거웠던 굿바이
    ## 26391         '송광민 끝내기' 한화의 재역전 드라마, 두산 꺾고 단독 2위
    ## 20007             '삼성 밖에 모르는 바보' 박한이, 영원한 삼성맨 택했다
    ## 12749    '켈리 완벽투+홈런 3방' SK, 두산에 7-2 승.. 2승 1패 리드 [KS3]
    ##              press  rname resp like sad angry fan want
    ## 27225 엑스포츠뉴스 조은혜 5303 4338  41   161 725   38
    ## 1286      연합뉴스 하남직 2291 1435   7   364 479    6
    ## 571       연합뉴스 이진욱 2529 1997  14    19 454   45
    ## 12815     스타뉴스 김우종 3908 3125  78   216 453   36
    ## 19744         OSEN 한용섭 2511 1872  25   166 423   25
    ## 7994    스포츠조선 허상욱 3962 3317  19   152 422   52
    ## 19840         OSEN 서정환 2240 1631 118    33 419   39
    ## 26391 엑스포츠뉴스 조은혜 2909 2308  20   135 416   30
    ## 20007         OSEN 손찬익 2530 1976  27    86 415   26
    ## 12749     스타뉴스 심혜진 2291 1748  22   113 395   13

2018년 한국시리즈 우승은 SK 와이번즈가 차지했다는 뉴스가 '팬이에요'를 가장 많이 받았습니다. 나중에 보시면 알겠지만 샤이 SK팬이 커밍아웃을 한 것 같다는 생각이 드는 군요. ㅎㅎ

``` r
# '후속기사 원해요'를 가장 많이 받은 기사 목록입니다.
checkResponse(data = news, resp = 'want', top = 10)
```

    ##           date
    ## 2450  20180930
    ## 2525  20181008
    ## 2529  20181008
    ## 2400  20180926
    ## 25952 20181026
    ## 33489 20181026
    ## 2355  20180923
    ## 2519  20181007
    ## 2499  20181005
    ## 2463  20181001
    ##                                                                    title
    ## 2450               “오지환 사태, 책임져야 할 때” ‘감독’ 선동열 결단 필요
    ## 2525             “오지환 회의록 조작 혹은 실수?” 게임수·홈런순위 등 틀려
    ## 2529             “LG 코치, ‘오지환 선발’ 절충했다?” 직접 나와 설명할 때 
    ## 2400                   “이정후 부활…1위 ‘3리’차로 접근” 7게임, 3할7푼5리
    ## 25952                                         KIA-임창용 방출의 미스테리
    ## 33489                   KIA 임창용 방출에 팬들 '분노'…"헌신이 배신으로" 
    ## 2355                “‘6연패’ LG, QS 1회…볼넷 남발” 차우찬, 75개 볼넷 1위
    ## 2519           “오지환, 유격수 2위…말이 되나?” 삼진·실책 ‘1위’ 빠져 있어
    ## 2499  “비공개 전제 ‘오지환’ 자료 제출, 말이 되나?” 선동열, 전면 공개해야
    ## 2463                       “경기흐름 넘겨준 오지환 실책” 24개 압도적 1위
    ##            press  rname resp like sad angry fan want
    ## 2450    국민일보 김영석 4326  235  21   693  40 3337
    ## 2525    국민일보 김영석 2514  300  12  1542  67  593
    ## 2529    국민일보 김영석 1762  796  13   286 101  566
    ## 2400    국민일보 김영석  634   93  11     7  41  482
    ## 25952 일간스포츠 이형석 4323  228  80  3532  33  450
    ## 33489      뉴스1 남성진 1859   72  28  1406  12  341
    ## 2355    국민일보 김영석  510   32  15    28 145  290
    ## 2519    국민일보 김영석 2263 1257  16   654  52  284
    ## 2499    국민일보 김영석 2545  398  25  1790  56  276
    ## 2463    국민일보 김영석 2305 1756  37   143  98  271

올해 프로야구 뉴스를 뜨겁게 달구었던 선수, 누군지 아시죠? 예상대로 줄줄이 사탕입니다. 정말 안타깝습니다.

#### 2. 언론사 및 기자별 뉴스 평균 반응 확인

언론사 및 기자별로 작성한 뉴스의 평균 반응 데이터를 할당하면 해당 항목에 대해 막대그래프를 출력하는 사용자 정의 함수를 만듭니다. 이 과정을 통해 어떤 언론사에서 또는 어떤 기자가 작성한 뉴스가 평균적으로 얼마나 많은 `좋아요`나 `화나요`를 받았는지 확인할 수 있습니다. ~~그러니까 일종의 **어그로**를 끄는 언론사와 기자가 누군지 가늠해볼 수 있다고 할 것입니다. 이 부분은 왠지 떨리네요.~~

``` r
# 뉴스 평균 반응 데이터로 막대그래프를 그리는 사용자 정의 함수를 생성합니다. 
bargraphResp <- function(data, resp, top = 10) {
  
  # data와 resp 인자를 문자로 받아 R 객체의 값을 불러오도록 설정합니다. 
  dtn <- deparse(expr = substitute(expr = data))
  var <- eval(expr = parse(text = str_c(dtn, resp, sep = '$')))
  
  # 반응 항목의 위치를 지정합니다. 
  loc <- which(x = colnames(x = data) == resp)
  
  # 조건 내림차순으로 정렬하고 필요 컬럼만 추출합니다. 
  df <- data[order(x = var, decreasing = TRUE), c(1, loc)] %>% 
    head(n = top)
  
  # 컬럼명을 변경합니다. 
  colnames(x = df) <- c('구분' ,'평균')
  
  # 막대그래프에 출력할 컬럼을 추가합니다. 
  df$출력 <- df$평균 %>%
    sprintf(fmt = '%.1f', x = .) %>%
    str_pad(width = 3, side = 'right', pad = '0')
  
  # 막대그래프를 그립니다. 
  ggplot(
    data = df, 
    mapping = aes(
      x = reorder(x = 구분, X = -평균), 
      y = 평균)) + 
    geom_col(
      fill = c(rep(x = 'gray30', times = 5), 
               rep(x = 'gray80', times = top - 5))) + 
    geom_text(
      mapping = aes(label = 출력), 
      vjust = -0.5,
      size = 4) + 
    labs(
      x = '',
      y = '',
      title = str_c('관련 기사 평균 반응수 (', resp, ')')) + 
    mytheme 
  
}
```

``` r
# 언론사별로 뉴스 기사 평균 반응을 구합니다.
pressResp <- news %>% 
  dplyr::rename(언론사 = press) %>% 
  group_by(언론사) %>% 
  dplyr::summarise(
    기사건수 = n(), 
    총반응 = sum(x = resp),
    좋아요 = sum(x = like),
    슬퍼요 = sum(x = sad),
    화나요 = sum(x = angry),
    힘내요 = sum(x = fan),
    원해요 = sum(x = want)) %>% 
  dplyr::filter(기사건수 >= 100) %>% 
  mutate(
    총반응 = round(x = 총반응 / 기사건수, digits = 2L),
    좋아요 = round(x = 좋아요 / 기사건수, digits = 2L),
    슬퍼요 = round(x = 슬퍼요 / 기사건수, digits = 2L),
    화나요 = round(x = 화나요 / 기사건수, digits = 2L),
    힘내요 = round(x = 힘내요 / 기사건수, digits = 2L),
    원해요 = round(x = 원해요 / 기사건수, digits = 2L)) 
```

``` r
# '좋아요' 평균 반응이 가장 높은 언론사는 어디일까요? 
bargraphResp(data = pressResp, resp = '좋아요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-21-1.png)

``` r
# 슬픈 기사는 어떤 언론사에서 가장 많이 작성했을까요?
bargraphResp(data = pressResp, resp = '슬퍼요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-21-2.png)

``` r
# 프로야구 팬들을 자주 화나게 한 언론사는 어디일가요?
bargraphResp(data = pressResp, resp = '화나요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-21-3.png)

``` r
# '팬이에요'라는 응원을 가장 많이 받은 언론사는? 
bargraphResp(data = pressResp, resp = '힘내요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-21-4.png)

``` r
# 마지막으로 '후속기사'를 원하도록 궁금증을 유발한 언론사를 확인합니다. 
bargraphResp(data = pressResp, resp = '원해요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-21-5.png)

국민일보가 각 항목에서 상위에 진입해 있는 경우가 많네요. 특히 '후속기사 원해요'는 압도적이네요. 혹시 `영석이형` 때문인가요?

``` r
# 기자별로 뉴스 기사 평균 반응을 구합니다. 
reprtResp <- news %>% 
  dplyr::rename(기자 = reporter) %>% 
  group_by(기자) %>% 
  dplyr::summarise(
    기사건수 = n(), 
    총반응 = sum(x = resp),
    좋아요 = sum(x = like),
    슬퍼요 = sum(x = sad),
    화나요 = sum(x = angry),
    힘내요 = sum(x = fan),
    원해요 = sum(x = want)) %>% 
  dplyr::filter(기사건수 >= 100) %>% 
  mutate(
    총반응 = round(x = 총반응 / 기사건수, digits = 2L),
    좋아요 = round(x = 좋아요 / 기사건수, digits = 2L),
    슬퍼요 = round(x = 슬퍼요 / 기사건수, digits = 2L),
    화나요 = round(x = 화나요 / 기사건수, digits = 2L),
    힘내요 = round(x = 힘내요 / 기사건수, digits = 2L),
    원해요 = round(x = 원해요 / 기사건수, digits = 2L)) 
```

``` r
# '좋아요'를 가장 많이 받은 기자입니다. 
bargraphResp(data = reprtResp, resp = '좋아요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-23-1.png)

``` r
# '슬픈 기사' 전문 기자 명단입니다. 
bargraphResp(data = reprtResp, resp = '슬퍼요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-23-2.png)

``` r
# 팬들을 화나게 한 건 뉴스인가요? 아니면 기자인가요?
bargraphResp(data = reprtResp, resp = '화나요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-23-3.png)

``` r
# 팬들로부터 받는 응원은 기자를 춤추게 할까요?
bargraphResp(data = reprtResp, resp = '힘내요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-23-4.png)

``` r
# 후속기사가 필요 없도록 한 번에 시원하게 부탁합니다! 
bargraphResp(data = reprtResp, resp = '원해요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-23-5.png)

전 더이상 이 부분에 대해서는 언급 안하렵니다. 알아서 판단하시기 바랍니다.

#### 3. 뉴스 제목에 언급된 구단 및 선수별 평균 반응

기사 평균 반응 데이터로 살펴보는 마지막 항목은 뉴스 기사에 언급된 구단 및 선수별 관련 기사의 평균 반응입니다. 이것으로 각 구단과 선수에 대한 팬들의 반응을 엿볼 수 있을 것이라 기대됩니다. 막대그래프 그리는 함수는 이전에 만든 것을 사용하지만, 구단과 선수별 평균 반응을 구하는 함수를 별도로 만들어야 합니다.

``` r
# 구단 및 선수별 뉴스 기사의 평균 반응을 구하는 사용자 정의 함수를 생성합니다.
meanResp <- function(gb, gbNm) {
  
  if (gb == 'team') {
    dt <- news %>% dplyr::filter(str_detect(string = team, pattern = gbNm))
  } else if (gb == 'name') {
    dt <- news %>% dplyr::filter(str_detect(string = name, pattern = gbNm))
  }
    
  meanResp <- dt %>% 
    dplyr::summarise(
      기사건수 = n(), 
      총반응 = sum(x = resp),
      좋아요 = sum(x = like),
      슬퍼요 = sum(x = sad),
      화나요 = sum(x = angry),
      힘내요 = sum(x = fan),
      원해요 = sum(x = want)) %>% 
    dplyr::filter(기사건수 >= 100) %>% 
    mutate(
      총반응 = round(x = 총반응 / 기사건수, digits = 2L),
      좋아요 = round(x = 좋아요 / 기사건수, digits = 2L),
      슬퍼요 = round(x = 슬퍼요 / 기사건수, digits = 2L),
      화나요 = round(x = 화나요 / 기사건수, digits = 2L),
      힘내요 = round(x = 힘내요 / 기사건수, digits = 2L),
      원해요 = round(x = 원해요 / 기사건수, digits = 2L)) 
  
  meanResp <- cbind(구분 = gbNm, meanResp)  
  
  return(meanResp)
  
}
```

이 사용자 정의 함수를 사용하여 구단별 평균 반응을 구하겠습니다.

``` r
# 10개 구단별 뉴스의 평균 반응을 구합니다. 
teamResp <- data.frame()
teams <- mostTeam$구분

for (team in teams) {
  
  df <- meanResp(gb = 'team', gbNm = team)
  teamResp <- rbind(teamResp, df)
  
}
```

``` r
# '좋아요'를 가장 많이 받는 구단은 어디일까요? 
bargraphResp(data = teamResp, resp = '좋아요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-26-1.png)

``` r
# 팬들을 슬프게한 구단을 알아봅시다. 
bargraphResp(data = teamResp, resp = '슬퍼요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-26-2.png)

``` r
# 어느 구단인지 대충 짐작이 갑니다. 
bargraphResp(data = teamResp, resp = '화나요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-26-3.png)

``` r
# 팬들의 사랑을 많이 받았으니 올해 행복했을 겁니다. 
bargraphResp(data = teamResp, resp = '힘내요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-26-4.png)

``` r
# 후속기사가 필요한 구단이라면 의심스러운 구석이 많겠죠? 
bargraphResp(data = teamResp, resp = '원해요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-26-5.png)

뉴스 제목에 언급된 선수별로도 같은 분석을 실시해보겠습니다.

``` r
# 선수별 뉴스의 평균 반응을 구합니다.
nameResp <- data.frame()
names <- mostName$구분[1:10]

for (name in names) {
  
  df <- meanResp(gb = 'name', gbNm = name)
  nameResp <- rbind(nameResp, df)
  
}
```

``` r
# 팬들이 가장 좋아했던 그 선수, 누굽니까?
bargraphResp(data = nameResp, resp = '좋아요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-28-1.png)

``` r
# 부상 때문일까요? 무엇이 팬들을 슬프게 했을까요? 
bargraphResp(data = nameResp, resp = '슬퍼요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-28-2.png)

``` r
# 이건 척하면 척이죠. 
bargraphResp(data = nameResp, resp = '화나요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-28-3.png)

``` r
# 사랑과 격려를 한 몸에 받은 그대, 행복했나요? 
bargraphResp(data = nameResp, resp = '힘내요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-28-4.png)

``` r
# 아~ 눈물납니다. 
bargraphResp(data = nameResp, resp = '원해요')
```

![](https://raw.githubusercontent.com/MrKevinNa/MrKevinNa.github.io/master/images/2018-12-21-2018-프로야구-기사로-본-이모저모/unnamed-chunk-28-5.png)

저는 이 내용에 대해서도 자세한 언급을 피하겠습니다.

#### 4. 구단별 관련 기사 중 가장 많은 반응을 받은 뉴스 목록

``` r
# 구단 관련 뉴스 중 가장 인기 있었던 뉴스 제목을 추출하는 사용자 정의 함수를 생성합니다. 
teamResponse <- function(teamName, resp, top = 5) {
  
  # 조건에 맞는 데이터셋 추출
  data <- news %>% dplyr::filter(team == teamName)
  
  # 조건으로 내림차순 정렬한 기사 출력 
  checkResponse(data = data, resp = resp, top = top)
  
}
```

올해 뜨거운 반응을 받은 LG 구단에 대해서만 살펴보겠습니다.

``` r
# '좋아요'를 가장 많이 받는 상위 10개 뉴스 
teamResponse(teamName = 'LG', resp = 'like', top = 10)
```

    ##          date
    ## 229  20181001
    ## 1741 20180902
    ## 1808 20180930
    ## 242  20181007
    ## 3085 20180929
    ## 2171 20180812
    ## 225  20180930
    ## 1048 20180507
    ## 1973 20180327
    ## 1200 20181008
    ##                                                                      title
    ## 229                          “경기흐름 넘겨준 오지환 실책” 24개 압도적 1위
    ## 1741                    1년 전 오지환의 꿈과 선택, 이토록 비난 받을 일인가
    ## 1808 [오!쎈 승부처] '엉성한 수비+병살 행진' LG, 제 발로 들어간 17연패 터널
    ## 242              “오지환, 유격수 2위…말이 되나?” 삼진·실책 ‘1위’ 빠져 있어
    ## 3085                           선동열 감독, 오지환 문제로 국회에 출석하나?
    ## 2171                                ‘교체 검토’ 논란의 오지환 대표팀 낙마?
    ## 225                         “오지환, 삼진 140개 채웠다” 역대 시즌 5위 기록
    ## 1048                      '200여명' 전부 다 사인해주고 떠난 LG 선수 '따뜻'
    ## 1973                    변함없는 LG의 지는 패턴, 그래서 더 슬픈 개막 2연패
    ## 1200                   이제 산술적 가능성도 0%..LG, 2년 연속 PS 탈락 확정 
    ##           press  rname resp like sad angry fan want
    ## 229    국민일보 김영석 2305 1756  37   143  98  271
    ## 1741       OSEN 한용섭 6579 1656  70  4703  84   66
    ## 1808       OSEN 이종서 1545 1259  17    73 165   31
    ## 242    국민일보 김영석 2263 1257  16   654  52  284
    ## 3085   MK스포츠 강대호 1477 1174  25   228  15   35
    ## 2171   데일리안   <NA> 1489 1169  20   202  31   67
    ## 225    국민일보 김영석 1446 1076  12    63  98  197
    ## 1048   스타뉴스 김우종 1134  915  15   104  85   15
    ## 1973 마이데일리 윤욱재 1709  910  99   583  69   48
    ## 1200   스타뉴스 한동훈 1103  907  34   107  43   12

``` r
# '슬퍼요'를 가장 많이 받는 상위 10개 뉴스 
teamResponse(teamName = 'LG', resp = 'sad', top = 10)
```

    ##          date
    ## 2004 20180520
    ## 3502 20180919
    ## 1186 20180928
    ## 2619 20180520
    ## 915  20180520
    ## 3483 20181127
    ## 1825 20181014
    ## 401  20181126
    ## 3174 20180521
    ## 1027 20180421
    ##                                                                       title
    ## 2004                               LG "구본무 회장 별세로 응원단 앰프 자제"
    ## 3502                     [단독] ‘국대ㆍLG’ 일으킨 봉중근 재활 중단 은퇴한다
    ## 1186 [공식은퇴] 봉중근 "멀리 떠나는 것 아냐..LG서 큰 꿈 이룰 것" (일문일답)
    ## 2619                               LG 구본무 회장 별세…잠실구장도 추모 물결
    ## 915                  LG 트윈스 응원전 취소…야구를 사랑했던 구본무 회장 추모
    ## 3483         LG 이상훈 코치 자진사퇴, 차명석 단장 "47번 비워놓고 기다릴 것"
    ## 1825                        [오피셜] 차우찬, 팔꿈치 뼛조각 제거 수술 받는다
    ## 401                                니느님·굴비 소사…이제는 헤어져야 할 시간
    ## 3174               봉인된 롤렉스와 우승주…LG의 과제가 된 구본무 회장의 유산
    ## 1027                                 LG 박용택, 어지러움 느껴 3회 대타 교체
    ##           press  rname resp like sad angry fan want
    ## 2004 마이데일리 윤욱재  645   34 516    77   8   10
    ## 3502   한국일보 성환희  537   38 426    12  50   11
    ## 1186   스타뉴스 한동훈  382   67 246    29  39    1
    ## 2619 스포츠동아 김종원  241   12 215    10   2    2
    ## 915    노컷뉴스 박세운  235    8 214     4   2    7
    ## 3483 스포츠서울 최승섭  369   57 212    78   9   13
    ## 1825       OSEN 한용섭  364   44 175   120  12   13
    ## 401    경향신문 이용균  194    6 163     9   8    8
    ## 3174      뉴스1 박지혜  191    9 161    12   4    5
    ## 1027   스타뉴스 한동훈  200   22 155    15   3    5

``` r
# '화나요'를 가장 많이 받는 상위 10개 뉴스 
teamResponse(teamName = 'LG', resp = 'angry', top = 10)
```

    ##          date
    ## 1741 20180902
    ## 1747 20180904
    ## 2076 20180902
    ## 309  20180905
    ## 2525 20180907
    ## 113  20180419
    ## 3274 20181005
    ## 3799 20180904
    ## 3261 20180613
    ## 1759 20180907
    ##                                                                    title
    ## 1741                  1년 전 오지환의 꿈과 선택, 이토록 비난 받을 일인가
    ## 1747                 인민재판 받은 오지환, 야구인들의 안타까운 시선 [AG]
    ## 2076                       '금메달' 오지환·박해민, 아시안게임은 해피엔딩
    ## 309   오지환 논란에 靑청원까지…“병역 혜택 취소하라” “오지환법 제정 촉구”
    ## 2525 [엑's 현장] 맹타 휘두른 오지환 "부모님과 팬들께 죄송하다"(일문일답)
    ## 113               LG 트윈스, 적나라한 사인 훔치기?…더그아웃 '커닝페이퍼'
    ## 3274                KBO 회의록 살펴보니 “오지환, 김하성 이은 유격수 2위”
    ## 3799                           경직된 선동열호, 정적 깬 "오지환 파이팅!"
    ## 3261                ‘오지환 싫다, 금메달 NO’ 저주 속에 출범하는 선동열호
    ## 1759                         "죄송하다"는 오지환의 사과, 팬심이 달래질까
    ##             press  rname resp like sad angry fan want
    ## 1741         OSEN 한용섭 6579 1656  70  4703  84   66
    ## 1747         OSEN 이상학 4122  187 151  3681  50   53
    ## 2076   마이데일리 김진성 4334  671  25  3569  49   20
    ## 309      동아일보 김민성 3884  346 137  3229  91   81
    ## 2525 엑스포츠뉴스 채정연 3805  710  56  2922  95   22
    ## 113        뉴시스 류형근 3071   95  21  2776  29  150
    ## 3274       뉴스엔 안형준 3286  422  43  2719  42   60
    ## 3799 스포티비뉴스 곽혜미 3030  370  30  2555  51   24
    ## 3261       뉴스엔 안형준 2971  270  64  2539  55   43
    ## 1759         OSEN 한용섭 2931  320  60  2439  76   36

``` r
# '팬이에요'를 가장 많이 받는 상위 10개 뉴스 
teamResponse(teamName = 'LG', resp = 'fan', top = 10)
```

    ##          date
    ## 3704 20180623
    ## 1808 20180930
    ## 216  20180923
    ## 3303 20180620
    ## 53   20180606
    ## 3406 20180617
    ## 1830 20181019
    ## 1672 20180803
    ## 718  20180610
    ## 361  20180618
    ##                                                                      title
    ## 3704               '통산 2,319안타' LG 박용택, 양준혁 넘어 KBO 대기록 달성
    ## 1808 [오!쎈 승부처] '엉성한 수비+병살 행진' LG, 제 발로 들어간 17연패 터널
    ## 216                   “‘6연패’ LG, QS 1회…볼넷 남발” 차우찬, 75개 볼넷 1위
    ## 3303            [S포트라이트] '규정타석 진입' 이형종, 단숨에 타율 3위 등극
    ## 53                   '운명의 일주일' 오지환, 4안타+기민한 주루로 매력 어필
    ## 3406      1000G 4출루 오지환 "지도자 분들께 감사…앞으로 더 좋은 모습 약속"
    ## 1830                [오피셜] LG, 차명석 신임 단장 임명...코칭스태프도 개편
    ## 1672                   [오!쎈 현장분석] '13연패' LG, 깨지 못한 '곰의 악몽'
    ## 718                              평균수준이라던 LG 윌슨, 활약상은 톱클래스
    ## 361                      5득점-4타점 합작 이형종-오지환, 3연승 LG 3위 도약
    ##             press  rname resp like sad angry fan want
    ## 3704 스포티비뉴스 한희재  863  641   4    26 183    9
    ## 1808         OSEN 이종서 1545 1259  17    73 165   31
    ## 216      국민일보 김영석  510   32  15    28 145  290
    ## 3303   STN 스포츠 윤승재  623  450   2    19 143    9
    ## 53       연합뉴스 김인철  753  433   4   171 136    9
    ## 3406   스포츠서울 배우근 1165  565   3   455 132   10
    ## 1830         OSEN 한용섭 1111  842  24    65 131   49
    ## 1672         OSEN 이종서  983  782  16    42 128   15
    ## 718    스포츠조선 최문영  637  477   6    17 122   15
    ## 361      중앙일보 김효경  613  437   5    50 116    5

``` r
# '후속기사 원해요'를 가장 많이 받는 상위 10개 뉴스 
teamResponse(teamName = 'LG', resp = 'want', top = 10)
```

    ##         date
    ## 226 20180930
    ## 243 20181008
    ## 244 20181008
    ## 216 20180923
    ## 242 20181007
    ## 238 20181005
    ## 229 20181001
    ## 225 20180930
    ## 113 20180419
    ## 233 20181003
    ##                                                                  title
    ## 226              “오지환 사태, 책임져야 할 때” ‘감독’ 선동열 결단 필요
    ## 243            “오지환 회의록 조작 혹은 실수?” 게임수·홈런순위 등 틀려
    ## 244            “LG 코치, ‘오지환 선발’ 절충했다?” 직접 나와 설명할 때 
    ## 216               “‘6연패’ LG, QS 1회…볼넷 남발” 차우찬, 75개 볼넷 1위
    ## 242          “오지환, 유격수 2위…말이 되나?” 삼진·실책 ‘1위’ 빠져 있어
    ## 238 “비공개 전제 ‘오지환’ 자료 제출, 말이 되나?” 선동열, 전면 공개해야
    ## 229                      “경기흐름 넘겨준 오지환 실책” 24개 압도적 1위
    ## 225                     “오지환, 삼진 140개 채웠다” 역대 시즌 5위 기록
    ## 113             LG 트윈스, 적나라한 사인 훔치기?…더그아웃 '커닝페이퍼'
    ## 233                “오지환에 가려져 있는 박해민” 제대로된 말을 할 때다
    ##        press  rname resp like sad angry fan want
    ## 226 국민일보 김영석 4326  235  21   693  40 3337
    ## 243 국민일보 김영석 2514  300  12  1542  67  593
    ## 244 국민일보 김영석 1762  796  13   286 101  566
    ## 216 국민일보 김영석  510   32  15    28 145  290
    ## 242 국민일보 김영석 2263 1257  16   654  52  284
    ## 238 국민일보 김영석 2545  398  25  1790  56  276
    ## 229 국민일보 김영석 2305 1756  37   143  98  271
    ## 225 국민일보 김영석 1446 1076  12    63  98  197
    ## 113   뉴시스 류형근 3071   95  21  2776  29  150
    ## 233 국민일보 김영석 1500  607  13   726  49  105

이상으로 **2018 프로야구 기사로 본 이모저모**를 마칩니다.

[1] **마스터 데이터셋**은 다운로드 하실 수 있도록 링크를 연결해놨습니다. 다만 크롤링과 전처리에 사용한 코드를 공유해드리지 못하는 점 양해 바랍니다. 대신 직접 수행하실 때 궁금한 점을 질문하시면 제가 성심성의껏 답변드리겠습니다.
